# ResNetClassifier
自己拿来分类图库的一个基于ResNet训练的模型demo

# 一、须知
在首次启动main.py时，会自动检测本地是否存在data文件夹，若不存在，则会自动创建data文件夹，并在其目录下创建分类结果、需要分类的图片、dataset和models四个子文件夹。
执行main.py后，会进行图片分类，分类结束后会自动对分类结果进行去重，删除重复图片。

* 分类结果：执行分类程序后对“需要分类的图片”的分类结果。
* 需要分类的图片：用户需要分类的图片。
* dataset：训练数据集。
* models：预训练模型，和用户训练的模型

# 二、训练模型
如果你想要训练一个自己的图片分类模型，请在data/dataset文件夹下创建对应个文件夹，文件夹的名字就是你的分类标签，然后将你的训练数据（图片）放在这个文件夹里。
例如：dataset里有五个文件夹，分别是a.美少女,b.风景,c.动物,d.美食,e.游戏，那么你的训练图片就应该放到各自对应的文件夹中。

在data/dataset文件夹下创建好你的训练数据后，运行main.py，程序会自动在预训练模型的基础上开始训练模型。

由于GitHub repo的最大储存限制，对应的预训练ResNet模型文件太大无法上传，我放了一份在我自己的网盘里：https://data.lapis.cafe/api/raw?path=/03.%E6%96%87%E4%BB%B6%E5%88%86%E4%BA%AB/resnet18-f37072fd.pth

当然，你也可以自行下载模型文件，默认会将预训练模型放在`./data/models/resnet18-f37072fd.pth`，

模型训练结束后，会自动将模型保存到`./data/models/`文件夹下，文件名格式为`model.pth`，并绘制并保存loss值图表到根目录下，文件名格式为`training_loss.png`。

# 三、开始分类
当你自己的模型训练好之后，可以运行main.py，程序会自动开始分类，基于你训练好的模型进行分类后，会执行一遍去重操作，删除重复图片。分类的结果可以在`./data/分类结果/`文件夹下查看。